deploy_docs:
  if: github.ref == 'refs/heads/main'
  runs-on: ubuntu-latest
  environment: production
  env:
    DOCS_MODE: ${{ secrets.DOCS_MODE }}  # Set this secret to "serve" for local serving, or leave empty for gh-deploy.
  steps:
    - uses: actions/checkout@v4
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'
    - name: Install MkDocs and Dependencies
      run: |
        pip install mkdocs mkdocs-material
    - name: Build MkDocs Site
      run: mkdocs build
    - name: Deploy or Serve MkDocs Site
      run: |
        if [ "${DOCS_MODE}" = "serve" ]; then
          echo "Serving MkDocs site on 0.0.0.0:8000..."
          mkdocs serve --dev-addr 0.0.0.0:8000
        else
          echo "Deploying MkDocs site via GitHub Pages..."
          mkdocs gh-deploy --force
        fi
